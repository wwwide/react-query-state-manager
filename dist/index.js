"use strict";var Kt=Object.create;var x=Object.defineProperty;var At=Object.getOwnPropertyDescriptor;var qt=Object.getOwnPropertyNames;var jt=Object.getPrototypeOf,Lt=Object.prototype.hasOwnProperty;var Vt=(t,e)=>{for(var s in e)x(t,s,{get:e[s],enumerable:!0})},J=(t,e,s,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of qt(e))!Lt.call(t,i)&&i!==s&&x(t,i,{get:()=>e[i],enumerable:!(r=At(e,i))||r.enumerable});return t};var R=(t,e,s)=>(s=t!=null?Kt(jt(t)):{},J(e||!t||!t.__esModule?x(s,"default",{value:t,enumerable:!0}):s,t)),Bt=t=>J(x({},"__esModule",{value:!0}),t);var te={};Vt(te,{useMutationManager:()=>Zt,useStateManager:()=>Yt});module.exports=Bt(te);var v=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}};var S=typeof window>"u"||"Deno"in globalThis;function Z(){}function A(t){return typeof t=="number"&&t>=0&&t!==1/0}function tt(t,e){return Math.max(t+(e||0)-Date.now(),0)}function q(t){return JSON.stringify(t,(e,s)=>K(s)?Object.keys(s).sort().reduce((r,i)=>(r[i]=s[i],r),{}):s)}function et(t,e){if(t===e)return t;let s=X(t)&&X(e);if(s||K(t)&&K(e)){let r=s?t:Object.keys(t),i=r.length,h=s?e:Object.keys(e),a=h.length,u=s?[]:{},c=0;for(let l=0;l<a;l++){let n=s?l:h[l];!s&&t[n]===void 0&&e[n]===void 0&&r.includes(n)?(u[n]=void 0,c++):(u[n]=et(t[n],e[n]),u[n]===t[n]&&t[n]!==void 0&&c++)}return i===a&&c===i?t:u}return e}function O(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(let s in t)if(t[s]!==e[s])return!1;return!0}function X(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function K(t){if(!Y(t))return!1;let e=t.constructor;if(e===void 0)return!0;let s=e.prototype;return!(!Y(s)||!s.hasOwnProperty("isPrototypeOf"))}function Y(t){return Object.prototype.toString.call(t)==="[object Object]"}function j(t,e,s){return typeof s.structuralSharing=="function"?s.structuralSharing(t,e):s.structuralSharing!==!1?et(t,e):e}var ne=Symbol();var Ht=class extends v{#e;#t;#s;constructor(){super(),this.#s=t=>{if(!S&&window.addEventListener){let e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#s)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#s=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){let t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},st=new Ht;var Nt=class extends v{#e=!0;#t;#s;constructor(){super(),this.#s=t=>{if(!S&&window.addEventListener){let e=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}}}}onSubscribe(){this.#t||this.setEventListener(this.#s)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#s=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(s=>{s(t)}))}isOnline(){return this.#e}},rt=new Nt;function it(t){return(t??"online")==="online"?rt.isOnline():!0}function Gt(){let t=[],e=0,s=o=>{o()},r=o=>{o()},i=o=>setTimeout(o,0),h=o=>{i=o},a=o=>{let d;e++;try{d=o()}finally{e--,e||l()}return d},u=o=>{e?t.push(o):i(()=>{s(o)})},c=o=>(...d)=>{u(()=>{o(...d)})},l=()=>{let o=t;t=[],o.length&&i(()=>{r(()=>{o.forEach(d=>{s(d)})})})};return{batch:a,batchCalls:c,schedule:u,setNotifyFunction:o=>{s=o},setBatchNotifyFunction:o=>{r=o},setScheduler:h}}var p=Gt();function nt(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:it(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function ot(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var V=class extends v{constructor(t,e){super(),this.options=e,this.#e=t,this.#n=null,this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#s=void 0;#r=void 0;#i;#o;#n;#p;#l;#f;#u;#h;#a;#d=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),at(this.#t,this.options)?this.#c():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return L(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return L(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#g(),this.#S(),this.#t.removeObserver(this)}setOptions(t,e){let s=this.options,r=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.#R(),this.#t.setOptions(this.options),s._defaulted&&!O(this.options,s)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});let i=this.hasListeners();i&&ut(this.#t,r,this.options,s)&&this.#c(),this.updateResult(e),i&&(this.#t!==r||this.options.enabled!==s.enabled||this.options.staleTime!==s.staleTime)&&this.#y();let h=this.#m();i&&(this.#t!==r||this.options.enabled!==s.enabled||h!==this.#a)&&this.#v(h)}getOptimisticResult(t){let e=this.#e.getQueryCache().build(this.#e,t),s=this.createResult(e,t);return Wt(this,s)&&(this.#r=s,this.#o=this.options,this.#i=this.#t.state),s}getCurrentResult(){return this.#r}trackResult(t,e){let s={};return Object.keys(t).forEach(r=>{Object.defineProperty(s,r,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(r),e?.(r),t[r])})}),s}trackProp(t){this.#d.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){let e=this.#e.defaultQueryOptions(t),s=this.#e.getQueryCache().build(this.#e,e);return s.isFetchingOptimistic=!0,s.fetch().then(()=>this.createResult(s,e))}fetch(t){return this.#c({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#r))}#c(t){this.#R();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(Z)),e}#y(){if(this.#g(),S||this.#r.isStale||!A(this.options.staleTime))return;let e=tt(this.#r.dataUpdatedAt,this.options.staleTime)+1;this.#u=setTimeout(()=>{this.#r.isStale||this.updateResult()},e)}#m(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#v(t){this.#S(),this.#a=t,!(S||this.options.enabled===!1||!A(this.#a)||this.#a===0)&&(this.#h=setInterval(()=>{(this.options.refetchIntervalInBackground||st.isFocused())&&this.#c()},this.#a))}#b(){this.#y(),this.#v(this.#m())}#g(){this.#u&&(clearTimeout(this.#u),this.#u=void 0)}#S(){this.#h&&(clearInterval(this.#h),this.#h=void 0)}createResult(t,e){let s=this.#t,r=this.options,i=this.#r,h=this.#i,a=this.#o,c=t!==s?t.state:this.#s,{state:l}=t,n={...l},C=!1,o;if(e._optimisticResults){let f=this.hasListeners(),I=!f&&at(t,e),It=f&&ut(t,s,e,r);(I||It)&&(n={...n,...nt(l.data,t.options)}),e._optimisticResults==="isRestoring"&&(n.fetchStatus="idle")}let{error:d,errorUpdatedAt:W,status:g}=n;if(e.select&&n.data!==void 0)if(i&&n.data===h?.data&&e.select===this.#p)o=this.#l;else try{this.#p=e.select,o=e.select(n.data),o=j(i?.data,o,e),this.#l=o,this.#n=null}catch(f){this.#n=f}else o=n.data;if(e.placeholderData!==void 0&&o===void 0&&g==="pending"){let f;if(i?.isPlaceholderData&&e.placeholderData===a?.placeholderData)f=i.data;else if(f=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,e.select&&f!==void 0)try{f=e.select(f),this.#n=null}catch(I){this.#n=I}f!==void 0&&(g="success",o=j(i?.data,f,e),C=!0)}this.#n&&(d=this.#n,o=this.#l,W=Date.now(),g="error");let P=n.fetchStatus==="fetching",U=g==="pending",k=g==="error",z=U&&P,$=o!==void 0;return{status:g,fetchStatus:n.fetchStatus,isPending:U,isSuccess:g==="success",isError:k,isInitialLoading:z,isLoading:z,data:o,dataUpdatedAt:n.dataUpdatedAt,error:d,errorUpdatedAt:W,failureCount:n.fetchFailureCount,failureReason:n.fetchFailureReason,errorUpdateCount:n.errorUpdateCount,isFetched:n.dataUpdateCount>0||n.errorUpdateCount>0,isFetchedAfterMount:n.dataUpdateCount>c.dataUpdateCount||n.errorUpdateCount>c.errorUpdateCount,isFetching:P,isRefetching:P&&!U,isLoadingError:k&&!$,isPaused:n.fetchStatus==="paused",isPlaceholderData:C,isRefetchError:k&&$,isStale:B(t,e),refetch:this.refetch}}updateResult(t){let e=this.#r,s=this.createResult(this.#t,this.options);if(this.#i=this.#t.state,this.#o=this.options,this.#i.data!==void 0&&(this.#f=this.#t),O(s,e))return;this.#r=s;let r={},i=()=>{if(!e)return!0;let{notifyOnChangeProps:h}=this.options,a=typeof h=="function"?h():h;if(a==="all"||!a&&!this.#d.size)return!0;let u=new Set(a??this.#d);return this.options.throwOnError&&u.add("error"),Object.keys(this.#r).some(c=>{let l=c;return this.#r[l]!==e[l]&&u.has(l)})};t?.listeners!==!1&&i()&&(r.listeners=!0),this.#O({...r,...t})}#R(){let t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;let e=this.#t;this.#t=t,this.#s=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#O(t){p.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#r)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function _t(t,e){return e.enabled!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function at(t,e){return _t(t,e)||t.state.data!==void 0&&L(t,e,e.refetchOnMount)}function L(t,e,s){if(e.enabled!==!1){let r=typeof s=="function"?s(t):s;return r==="always"||r!==!1&&B(t,e)}return!1}function ut(t,e,s,r){return(t!==e||r.enabled===!1)&&(!s.suspense||t.state.status!=="error")&&B(t,s)}function B(t,e){return e.enabled!==!1&&t.isStaleByTime(e.staleTime)}function Wt(t,e){return!O(t.getCurrentResult(),e)}var H=class extends v{#e;#t=void 0;#s;#r;constructor(t,e){super(),this.#e=t,this.setOptions(e),this.bindMethods(),this.#i()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){let e=this.options;this.options=this.#e.defaultMutationOptions(t),O(this.options,e)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),e?.mutationKey&&this.options.mutationKey&&q(e.mutationKey)!==q(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(t){this.#i(),this.#o(t)}getCurrentResult(){return this.#t}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#i(),this.#o()}mutate(t,e){return this.#r=e,this.#s?.removeObserver(this),this.#s=this.#e.getMutationCache().build(this.#e,this.options),this.#s.addObserver(this),this.#s.execute(t)}#i(){let t=this.#s?.state??ot();this.#t={...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset}}#o(t){p.batch(()=>{if(this.#r&&this.hasListeners()){let e=this.#t.variables,s=this.#t.context;t?.type==="success"?(this.#r.onSuccess?.(t.data,e,s),this.#r.onSettled?.(t.data,null,e,s)):t?.type==="error"&&(this.#r.onError?.(t.error,e,s),this.#r.onSettled?.(void 0,t.error,e,s))}this.listeners.forEach(e=>{e(this.#t)})})}};var E=R(require("react"),1),zt=require("react/jsx-runtime"),ht=E.createContext(void 0),y=t=>{let e=E.useContext(ht);if(t)return t;if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e};var F=R(require("react"),1),ct=F.createContext(!1),lt=()=>F.useContext(ct),Be=ct.Provider;var Q=R(require("react"),1),$t=require("react/jsx-runtime");function Jt(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var Xt=Q.createContext(Jt()),ft=()=>Q.useContext(Xt);var pt=R(require("react"),1);function T(t,e){return typeof t=="function"?t(...e):!!t}function dt(){}var yt=(t,e)=>{(t.suspense||t.throwOnError)&&(e.isReset()||(t.retryOnMount=!1))},mt=t=>{pt.useEffect(()=>{t.clearReset()},[t])},vt=({result:t,errorResetBoundary:e,throwOnError:s,query:r})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&T(s,[t.error,r]);var bt=t=>{t.suspense&&typeof t.staleTime!="number"&&(t.staleTime=1e3)};var gt=(t,e)=>t?.suspense&&e.isPending,St=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});var b=R(require("react"),1);function Rt(t,e,s){let r=y(s),i=lt(),h=ft(),a=r.defaultQueryOptions(t);a._optimisticResults=i?"isRestoring":"optimistic",bt(a),yt(a,h),mt(h);let[u]=b.useState(()=>new e(r,a)),c=u.getOptimisticResult(a);if(b.useSyncExternalStore(b.useCallback(l=>{let n=i?()=>{}:u.subscribe(p.batchCalls(l));return u.updateResult(),n},[u,i]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),b.useEffect(()=>{u.setOptions(a,{listeners:!1})},[a,u]),gt(a,c))throw St(a,u,h);if(vt({result:c,errorResetBoundary:h,throwOnError:a.throwOnError,query:r.getQueryCache().get(a.queryHash)}))throw c.error;return a.notifyOnChangeProps?c:u.trackResult(c)}function N(t,e){return Rt(t,V,e)}var m=R(require("react"),1);function G(t,e){let s=y(e),[r]=m.useState(()=>new H(s,t));m.useEffect(()=>{r.setOptions(t)},[r,t]);let i=m.useSyncExternalStore(m.useCallback(a=>r.subscribe(p.batchCalls(a)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),h=m.useCallback((a,u)=>{r.mutate(a,u).catch(dt)},[r]);if(i.error&&T(r.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:h,mutateAsync:i.mutate}}var _=require("react"),D=(t,e)=>{t.removeQueries({queryKey:e})},Ot=t=>{t.removeQueries()},Ct=t=>{let e=(0,_.useCallback)(r=>D(t,r),[D]),s=(0,_.useCallback)(()=>Ot(t),[Ot]);return{remove:e,removeAll:s}};var Qt=require("react"),Et=(t,e,s)=>t.setQueryData(e,s),wt=t=>({set:(0,Qt.useCallback)((s,r)=>Et(t,s,r),[Et])});var Ft=require("react"),xt=(t,e)=>t.getQueryData(e),Tt=t=>({get:(0,Ft.useCallback)(s=>xt(t,s),[xt])});var M=require("react");var Dt=require("react"),w=(t,e)=>t.invalidateQueries({queryKey:e}),Mt=t=>({invalidate:(0,Dt.useCallback)(s=>w(t,s),[w])});var Pt=(t,e,s,r)=>{let i=s||y(),{data:h,isFetching:a,isFetched:u,isError:c,isSuccess:l,status:n,error:C}=N({...r,queryKey:t,queryFn:e}),o=(0,M.useCallback)(()=>{D(i,t)},[i,t]),d=(0,M.useCallback)(()=>w(i,t),[w,i,t]);return{data:h,isFetching:a,isFetched:u,isError:c,isSuccess:l,status:n,error:C,cleanUp:o,invalidate:d}},Ut=t=>({use:(0,M.useCallback)((s,r,i)=>Pt(s,r,t,i),[Pt,t])});var Yt=()=>{let t=y(),{remove:e,removeAll:s}=Ct(t),{set:r}=wt(t),{get:i}=Tt(t),{invalidate:h}=Mt(t),{use:a}=Ut(t);return{__client__:t,get:i,set:r,invalidate:h,remove:e,removeAll:s,use:a}};var kt=require("react");var Zt=(t,e)=>{let{mutateAsync:s,isError:r,isSuccess:i,isPending:h,status:a}=G({mutationFn:c=>t(c)}),u=(0,kt.useCallback)(async c=>{try{e?.onBefore&&await e.onBefore(c);let l=await s(c);return e?.onSuccess&&await e.onSuccess(c,l),l}catch(l){throw e?.onError&&e.onError(l),l}finally{e?.onFinally&&e.onFinally()}},[e]);return{mutateAsync:s,routine:u,isError:r,isSuccess:i,isPending:h,status:a}};
